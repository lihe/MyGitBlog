# [从 RAG 到 GraphRAG，再到 LightRAG](https://github.com/lihe/MyGitBlog/issues/1)



## **引言：当 RAG 不再只是“找得到”**


检索增强生成（Retrieval-Augmented Generation, RAG）已经成为 LLM 应用的事实标准。

它通过“**先检索、再生成**”的方式，在一定程度上缓解了大模型的幻觉问题。


但随着应用场景从**局部事实问答**走向**跨文档推理、全局总结与复杂关系理解**，一个问题逐渐显现：

> **RAG 能检索到信息，但并不真正“理解结构”。**

GraphRAG 与 LightRAG，正是在这一背景下被提出的两种结构化检索方案。

------


## **一、传统 RAG 的结构性瓶颈**


传统 RAG 的系统抽象非常清晰：


- 文档 → Chunk
- Chunk → 向量
- Query → 相似度检索 → 上下文拼接


这种设计在以下任务中表现良好：


- 明确事实查询
- 定位具体段落
- 局部知识补全





但它存在一个**无法通过调参或模型升级解决的系统性限制**：



> **Chunk 是扁平的，而知识本身是结构化的。**





### **结构缺失带来的直接后果**





- 文档之间的关联关系被切断
- 实体之间的因果、从属、演化关系无法显式建模
- 模型只能“拼上下文”，而非“基于结构推理”





这意味着，当问题本身涉及**整体脉络、跨文档关系或宏观总结**时，传统 RAG 的能力上限会迅速暴露。



------





## **二、GraphRAG 是什么：第一次把“图结构”带入 RAG**




**GraphRAG** 是微软提出的一种 RAG 扩展框架，其核心目标并不是“检索更准的文本”，

而是：



> **让 RAG 具备显式建模和利用“知识结构”的能力。**



在 GraphRAG 中，知识不再被视为一堆独立的文本片段，而是被重构为一个**由实体与关系组成的图结构（Knowledge Graph）**。

RAG 的检索对象，也从“文本 Chunk”升级为“图中的结构单元”。



------





## **三、GraphRAG：显式引入“全局结构”的系统设计**







### **1. GraphRAG 的核心设计思路**





GraphRAG 的关键思想可以概括为一句话：



> **既然知识天然是图结构的，那就直接构建图，并在图的层面进行检索与摘要。**



为此，GraphRAG 在 indexing 阶段引入了一套完整但代价不菲的流程：



1. **实体与关系抽取**

   使用 LLM 从原始文本中抽取实体（人物、概念、事件）及其关系。

2. **知识图谱构建**

   将实体作为节点，关系作为边，形成全局图结构。

3. **社区发现（Community Detection）**

   使用 Leiden 等图算法，将高度相关的子图聚合为“社区”。

4. **社区级摘要生成**

   为每个社区预先生成结构化摘要，作为后续检索的高层语义单元。





------





### **2. GraphRAG 解决了什么本质问题？**





GraphRAG 首次在 RAG 框架中引入了**全局结构感知能力**：



- 不再只关注“相关段落”
- 而是能够回答“整体结构上发生了什么”





例如：



- “整个语料中反复出现的核心主题是什么？”
- “多个事件之间是否存在系统性关联？”





这类问题，本质上需要**跨文本、跨实体、跨关系的全局推理**，

而这正是 GraphRAG 的优势所在。



------





### **3. 但系统代价同样明确**





从工程角度看，GraphRAG 的主要问题并不在效果，而在**系统可持续性**：



- 索引阶段 Token 成本极高
- 社区结构对数据变化高度敏感
- 增量更新几乎不可行





因此，GraphRAG 更适合**离线分析型任务**，而非高频更新的在线系统。



------





## **四、LightRAG 是什么：对 GraphRAG 的工程化回应**






**LightRAG** 并不是对 GraphRAG 的否定，而是一种**面向工程现实的重新设计**。



它试图回答的问题是：



> **是否一定要构建“全局静态结构”，才能让 RAG 具备结构化推理能力？**



LightRAG 的答案是：**不一定。**



------





## **五、LightRAG：把结构留到 Query 时再用**







### **1. 设计立场的根本转变**





与 GraphRAG 相比，LightRAG 的核心转变在于：



- 不再预生成全局社区摘要
- 保留图结构，但不“冻结”结构语义
- 将结构的使用推迟到 Query 阶段





可以将两者的差异理解为：



> GraphRAG：**结构是提前计算好的**

> LightRAG：**结构是按需被查询和展开的**



------





### **2. 双层检索的工程意义**





LightRAG 采用了一种**图结构 + 向量检索的协同机制**：



- **向量层**：快速召回相关实体或节点
- **图结构层**：基于关系进行上下文扩展与约束





这种设计带来的直接好处是：



- 支持增量更新
- 检索路径随 Query 动态变化
- 成本与延迟显著降低





------





## **六、三种 RAG 方案的系统级对比**



| **维度**   | **传统 RAG** | **GraphRAG** | **LightRAG**  |
| ---------- | ------------ | ------------ | ------------- |
| 知识建模   | 扁平文本     | 显式全局图   | 局部图 + 向量 |
| 全局理解   | ❌            | ✅            | 部分支持      |
| 索引成本   | 低           | 极高         | 中等          |
| 增量更新   | 易           | 困难         | 易            |
| 工程可用性 | 高           | 低           | 高            |



------





## **七、结论：Graph 不是目的，结构化推理才是**





GraphRAG 与 LightRAG 的分歧，并不在“用不用图”，而在于：



> **结构化能力应当放在“离线建模”还是“在线推理”阶段。**





- GraphRAG 代表**认知完整性优先**
- LightRAG 代表**工程可落地性优先**





在可预见的未来，更可能的方向是：



> **图结构 × 向量检索 × 动态推理路径的融合系统**



------

